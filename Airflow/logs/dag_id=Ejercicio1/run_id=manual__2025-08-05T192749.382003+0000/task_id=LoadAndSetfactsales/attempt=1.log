[2025-08-05T19:28:02.503+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: Ejercicio1.LoadAndSetfactsales manual__2025-08-05T19:27:49.382003+00:00 [queued]>
[2025-08-05T19:28:02.563+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: Ejercicio1.LoadAndSetfactsales manual__2025-08-05T19:27:49.382003+00:00 [queued]>
[2025-08-05T19:28:02.565+0000] {taskinstance.py:2170} INFO - Starting attempt 1 of 2
[2025-08-05T19:28:02.631+0000] {taskinstance.py:2191} INFO - Executing <Task(PythonOperator): LoadAndSetfactsales> on 2025-08-05 19:27:49.382003+00:00
[2025-08-05T19:28:02.655+0000] {standard_task_runner.py:60} INFO - Started process 1120 to run task
[2025-08-05T19:28:02.779+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'Ejercicio1', 'LoadAndSetfactsales', 'manual__2025-08-05T19:27:49.382003+00:00', '--job-id', '143', '--raw', '--subdir', 'DAGS_FOLDER/ejercicio1.py', '--cfg-path', '/tmp/tmpdkkutwu1']
[2025-08-05T19:28:02.876+0000] {standard_task_runner.py:88} INFO - Job 143: Subtask LoadAndSetfactsales
[2025-08-05T19:28:03.372+0000] {task_command.py:423} INFO - Running <TaskInstance: Ejercicio1.LoadAndSetfactsales manual__2025-08-05T19:27:49.382003+00:00 [running]> on host 019b67754667
[2025-08-05T19:28:05.050+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='Ejercicio1' AIRFLOW_CTX_TASK_ID='LoadAndSetfactsales' AIRFLOW_CTX_EXECUTION_DATE='2025-08-05T19:27:49.382003+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-08-05T19:27:49.382003+00:00'
[2025-08-05T19:28:05.256+0000] {logging_mixin.py:188} INFO -    Salesid  Dateid  Productid  Segmentid  Price_PerUnit  QuantitySold
0    S1001       1       1001         19         299.99             3
1    S1002       2       1002         21          89.99            10
2    S1003       3       1003         31        1249.99             2
3    S1004       4       1004         32           5.99            40
4    S1005       5       1005         40         499.99             1
5    S1006       6       1006         43          20.00             5
6    S1007       7       1007         44          15.99            12
7    S1008       8       1008         46         120.00             7
8    S1009       9       1009         47          30.00            15
9    S1010      10       1010         48          65.50             4
10   S1011      11       1011         57          12.99            20
11   S1012      12       1012         71          45.00             8
12   S1013      13       1013         77         250.00             3
13   S1014      14       1014         81          35.00             6
14   S1015      15       1015         82          18.50             9
15   S1016      16       1001         83         299.99             2
16   S1017      17       1002         84          89.99            15
17   S1018      18       1003         86        1249.99             1
18   S1019      19       1004         97           5.99            35
19   S1020      20       1005         19         499.99             4
20   S1021      21       1006         21          20.00             6
21   S1022      22       1007         31          15.99            11
22   S1023      23       1008         32         120.00             5
23   S1024      24       1009         40          30.00            14
24   S1025      25       1010         43          65.50             7
[2025-08-05T19:28:05.261+0000] {taskinstance.py:2698} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'salesid'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 433, in _execute_task
    result = execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 199, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 216, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/ejercicio1.py", line 112, in call
    set_lastid(table,id,engine)
  File "/opt/airflow/dags/ejercicio1.py", line 97, in set_lastid
    last_id = df[cond].max()
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'salesid'
[2025-08-05T19:28:05.344+0000] {taskinstance.py:1138} INFO - Marking task as UP_FOR_RETRY. dag_id=Ejercicio1, task_id=LoadAndSetfactsales, execution_date=20250805T192749, start_date=20250805T192802, end_date=20250805T192805
[2025-08-05T19:28:05.403+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 143 for task LoadAndSetfactsales ('salesid'; 1120)
[2025-08-05T19:28:05.465+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2025-08-05T19:28:05.532+0000] {taskinstance.py:3280} INFO - 0 downstream tasks scheduled from follow-on schedule check
